(function(){"use strict";angular.module("tpl.modalManager",[])})();(function(){"use strict";var module=angular.module("tpl.modalManager");module.service("modalManager",modalManager);function modalManager(){var modalKeys=[];var modals=[];var service={saveModal:saveModal,closeModals:closeModals};return service;function saveModal(modal){modal.timestamp=(new Date).getTime();modalKeys.push(modal.timestamp);modals[modal.timestamp]=modal;if(modal.closePromise){modal.closePromise.then(function(){refreshModals()})}if(modal.result){modal.result.then(function(){refreshModals()},function(){refreshModals()})}function refreshModals(){var oldModalKeys=angular.copy(modalKeys);modalKeys=[];for(var i=0;i<oldModalKeys.length;i++){if(modal.timestamp!==oldModalKeys[i]){modalKeys.push(oldModalKeys[i])}}modals[modal.timestamp]=null}}function closeModals(){for(var i=0;i<modalKeys.length;i++){modals[modalKeys[i]].dismiss?modals[modalKeys[i]].dismiss():modals[modalKeys[i]].close?modals[modalKeys[i]].close():null}modalKeys=[];modals=[]}}})();